/*
Definition of special linked list:
struct ListNode {
    int val;
    ListNode *next;
    ListNode *child;
    ListNode() {
        val = 0;
        next = NULL;
        child = NULL;
    }
    ListNode(int data1) {
        val = data1;
        next = NULL;
        child = NULL;
    }
    ListNode(int data1, ListNode *next1, ListNode *child1) {
        val = data1;
        next = next1;
        child = child1;
    }
};
*/

class Solution {
public:
    // Function to merge two sorted linked lists by 'child' pointers
    ListNode* merge(ListNode* a, ListNode* b) {
        if (!a) return b;
        if (!b) return a;

        ListNode* result;

        if (a->val < b->val) {
            result = a;
            result->child = merge(a->child, b);
        } else {
            result = b;
            result->child = merge(a, b->child);
        }

        result->next = NULL; // ensure 'next' is null in flattened list
        return result;
    }

    ListNode* flattenLinkedList(ListNode* &head) {
        if (!head || !head->next) return head;

        // Flatten the remaining list on the right
        head->next = flattenLinkedList(head->next);

        // Merge current list with flattened next list
        head = merge(head, head->next);

        return head;
    }
};
