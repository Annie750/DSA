public boolean hasAllCodes(String s, int k) {
    int n = s.length();
    
    if (n - k + 1 < (1 << k)) return false;

    Set<Integer> seen = new HashSet<>();
    int hash = 0;
    int mask = (1 << k) - 1;

    for (int i = 0; i < n; i++) {
        hash = ((hash << 1) & mask) | (s.charAt(i) - '0');
        
        if (i >= k - 1) {
            seen.add(hash);
            if (seen.size() == (1 << k)) return true;
        }
    }

    return false;
}
